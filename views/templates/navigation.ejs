<script>
(function() {
    if (typeof window !== 'undefined' && !window.__bstatsTailwindInjected) {
        window.__bstatsTailwindInjected = true;
        var injectStylesheet = function() {
            if (document.querySelector('link[href*="/stylesheets/tailwind.css"]')) {
                return;
            }
            var link = document.createElement('link');
            link.rel = 'stylesheet';
            link.href = '/stylesheets/tailwind.css';
            link.media = 'all';
            if (document.head) {
                document.head.appendChild(link);
            } else {
                document.addEventListener('DOMContentLoaded', function() {
                    if (document.head && !document.querySelector('link[href*="/stylesheets/tailwind.css"]')) {
                        document.head.appendChild(link);
                    }
                }, { once: true });
            }
        };
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', injectStylesheet, { once: true });
        } else {
            injectStylesheet();
        }
    }

    var accentPalette = window.__bstatsAccentPalette || {
        teal: { base: '#0f766e', dark: '#115e59', soft: '#ccfbf1', contrast: '#f8fafc' },
        red: { base: '#b91c1c', dark: '#991b1b', soft: '#fee2e2', contrast: '#f8fafc' },
        blue: { base: '#1d4ed8', dark: '#1e40af', soft: '#dbeafe', contrast: '#f8fafc' },
        pink: { base: '#be185d', dark: '#9d174d', soft: '#fce7f3', contrast: '#f8fafc' },
        brown: { base: '#92400e', dark: '#78350f', soft: '#f5e2c8', contrast: '#fdfdfc' },
        green: { base: '#15803d', dark: '#166534', soft: '#dcfce7', contrast: '#f8fafc' },
        black: { base: '#0b1120', dark: '#020617', soft: '#1e293b', contrast: '#f8fafc' },
        purple: { base: '#6d28d9', dark: '#5b21b6', soft: '#ede9fe', contrast: '#f8fafc' },
        'deep-purple': { base: '#5b21b6', dark: '#4c1d95', soft: '#ede9fe', contrast: '#f8fafc' },
        indigo: { base: '#4338ca', dark: '#3730a3', soft: '#e0e7ff', contrast: '#f8fafc' },
        'light-blue': { base: '#0369a1', dark: '#075985', soft: '#e0f2fe', contrast: '#f8fafc' },
        cyan: { base: '#0e7490', dark: '#155e75', soft: '#cffafe', contrast: '#f8fafc' },
        'light-green': { base: '#4d7c0f', dark: '#3f6212', soft: '#ecfccb', contrast: '#fdfcf4' },
        lime: { base: '#3f6212', dark: '#365314', soft: '#f7fee7', contrast: '#fdfcf4' },
        yellow: { base: '#a16207', dark: '#854d0e', soft: '#fef9c3', contrast: '#1f2937' },
        amber: { base: '#b45309', dark: '#92400e', soft: '#fef3c7', contrast: '#fdfdfc' },
        orange: { base: '#c2410c', dark: '#9a3412', soft: '#ffedd5', contrast: '#fff7ed' },
        'deep-orange': { base: '#9a3412', dark: '#7c2d12', soft: '#ffe2d5', contrast: '#fff8f6' },
        grey: { base: '#4b5563', dark: '#374151', soft: '#f3f4f6', contrast: '#f8fafc' },
        'blue-grey': { base: '#334155', dark: '#1e293b', soft: '#e2e8f0', contrast: '#f8fafc' }
    };
    window.__bstatsAccentPalette = accentPalette;

    var accentKey = '<%= customColor1 %>' || 'teal';
    window.__bstatsAccent = accentKey;
    var palette = accentPalette[accentKey] || accentPalette['teal'];
    var root = document.documentElement;
    if (root) {
        root.style.setProperty('--accent-color', palette.base);
        root.style.setProperty('--accent-color-dark', palette.dark);
        root.style.setProperty('--accent-color-soft', palette.soft);
        root.style.setProperty('--accent-color-contrast', palette.contrast);
    }

    function applyAccentDataset() {
        if (document.body) {
            document.body.setAttribute('data-accent', accentKey);
        }
    }

    applyAccentDataset();
    document.addEventListener('DOMContentLoaded', applyAccentDataset, { once: true });
})();
</script>
<style>
    summary::-webkit-details-marker {
        display: none;
    }
    details > summary {
        list-style: none;
    }
</style>

<header class="relative z-50 border-b border-white/10 bg-slate-950/95 backdrop-blur">
    <div class="mx-auto flex max-w-7xl flex-col px-4 sm:px-6 lg:px-8">
        <div class="flex h-20 items-center justify-between">
            <a href="/" class="flex items-center gap-3 text-base font-semibold tracking-tight text-white">
                <span class="inline-flex h-10 w-10 items-center justify-center rounded-xl border border-white/10 bg-white/10 text-sm font-bold uppercase">bS</span>
                <span class="hidden text-lg sm:inline">bStats</span>
            </a>
            <nav class="hidden items-center gap-10 text-sm font-medium text-slate-300 lg:flex">
                <a href="/plugin-list" class="transition hover:text-white">Plugin list</a>
                <a href="/plugin/1337/random" class="transition hover:text-white">Random plugin</a>
                <% if (allSoftware && allSoftware.length > 0) { %>
                <details class="group relative">
                    <summary class="flex cursor-pointer items-center gap-2 text-sm font-medium text-slate-300 transition hover:text-white">
                        <span>Global stats</span>
                        <svg class="h-4 w-4 transition group-open:rotate-180" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                            <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 0 1 1.06.02L10 10.94l3.71-3.71a.75.75 0 0 1 1.08 1.04l-4.25 4.25a.75.75 0 0 1-1.08 0L5.21 8.27a.75.75 0 0 1 .02-1.06z" clip-rule="evenodd"></path>
                        </svg>
                    </summary>
                    <div class="invisible absolute right-0 top-full z-40 mt-4 w-64 -translate-y-2 rounded-2xl border border-white/10 bg-slate-900/95 p-3 text-sm text-slate-200 opacity-0 shadow-xl backdrop-blur transition duration-200 group-open:visible group-open:translate-y-0 group-open:opacity-100">
                        <div class="grid gap-1">
                            <% for (var i = 0; i < allSoftware.length; i++) { %>
                            <% if (allSoftware[i].globalPlugin) { %>
                            <a href="/global/<%= allSoftware[i].url %>" class="flex items-center justify-between rounded-xl px-3 py-2 transition hover:bg-white/10 hover:text-white">
                                <span class="truncate"><%= allSoftware[i].name %></span>
                                <svg class="h-4 w-4 opacity-60" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                    <path fill-rule="evenodd" d="M6.22 5.22a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1 0 1.06l-4.5 4.5a.75.75 0 1 1-1.06-1.06L9.44 11H5.5a.75.75 0 0 1 0-1.5h3.94L6.22 6.28a.75.75 0 0 1 0-1.06z" clip-rule="evenodd"></path>
                                </svg>
                            </a>
                            <% } %>
                            <% } %>
                            <% if (!allSoftware.some(function (s) { return s.globalPlugin; })) { %>
                            <span class="rounded-xl bg-white/5 px-3 py-2 text-sm text-slate-400">No global stats available yet.</span>
                            <% } %>
                        </div>
                    </div>
                </details>
                <% } %>
                <a href="/getting-started" class="transition hover:text-white">Docs</a>
                <a href="/credits" class="transition hover:text-white">Credits</a>
            </nav>
            <div class="hidden items-center gap-3 lg:flex">
                <% if (loggedIn) { %>
                <a href="/add-plugin" class="accent-bg inline-flex items-center gap-2 rounded-full px-4 py-2 text-sm font-semibold shadow-sm transition">
                    <svg class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                        <path fill-rule="evenodd" d="M10 3a.75.75 0 0 1 .75.75V9.25h5.5a.75.75 0 0 1 0 1.5h-5.5v5.5a.75.75 0 0 1-1.5 0v-5.5H3.75a.75.75 0 0 1 0-1.5h5.5V3.75A.75.75 0 0 1 10 3z" clip-rule="evenodd"></path>
                    </svg>
                    Add plugin
                </a>
                <details class="group relative">
                    <summary class="flex cursor-pointer items-center gap-2 rounded-full border border-white/10 bg-white/5 px-3 py-2 text-sm font-medium text-white transition hover:border-white/30">
                        <span class="max-w-[160px] truncate"><%= user.username %></span>
                        <svg class="h-4 w-4 transition group-open:rotate-180" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                            <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 0 1 1.06.02L10 10.94l3.71-3.71a.75.75 0 0 1 1.08 1.04l-4.25 4.25a.75.75 0 0 1-1.08 0L5.21 8.27a.75.75 0 0 1 .02-1.06z" clip-rule="evenodd"></path>
                        </svg>
                    </summary>
                    <div class="invisible absolute right-0 top-full z-40 mt-4 w-72 -translate-y-2 rounded-2xl border border-white/10 bg-slate-900/95 p-4 text-sm text-slate-200 opacity-0 shadow-xl backdrop-blur transition duration-200 group-open:visible group-open:translate-y-0 group-open:opacity-100">
                        <div class="flex flex-col gap-3">
                            <a href="/author/<%= user.username %>" class="transition hover:text-white">My profile</a>
                            <a href="/change-password" class="transition hover:text-white">Change password</a>
                            <a href="/logout" class="transition hover:text-white">Logout</a>
                            <% if (myPlugins && myPlugins.length > 0) { %>
                            <div class="h-px bg-white/10"></div>
                            <div class="text-xs uppercase tracking-wide text-slate-400">My plugins</div>
                            <div class="max-h-56 space-y-2 overflow-y-auto pr-1">
                                <% for (var i = 0; i < myPlugins.length; i++) { %>
                                <a href="/plugin/<%= myPlugins[i].software.url %>/<%= myPlugins[i].name %>" class="block truncate rounded-lg px-2 py-1 text-sm transition hover:bg-white/10 hover:text-white"><%= myPlugins[i].name %> (<%= myPlugins[i].software.name %>)</a>
                                <% } %>
                            </div>
                            <% } %>
                        </div>
                    </div>
                </details>
                <% } else { %>
                <a href="/login" class="rounded-full border border-white/15 px-4 py-2 text-sm font-semibold text-white transition hover:border-white/40">Login</a>
                <a href="/register" class="accent-bg inline-flex items-center rounded-full px-4 py-2 text-sm font-semibold shadow-sm transition">Create account</a>
                <% } %>
            </div>
            <button id="mobile-nav-toggle" type="button" class="inline-flex items-center justify-center rounded-full border border-white/15 bg-white/5 p-2 text-slate-300 transition hover:border-white/30 hover:text-white lg:hidden">
                <span class="sr-only">Toggle navigation</span>
                <svg class="h-5 w-5" data-icon="menu" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 7h16M4 12h16M4 17h16"></path>
                </svg>
                <svg class="hidden h-5 w-5" data-icon="close" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M6 6l12 12M6 18L18 6"></path>
                </svg>
            </button>
        </div>
        <div id="mobile-nav-panel" class="hidden flex-col gap-6 border-t border-white/10 py-6 text-sm font-medium text-slate-200 lg:hidden">
            <nav class="flex flex-col gap-3">
                <a href="/plugin-list" class="transition hover:text-white">Plugin list</a>
                <a href="/plugin/1337/random" class="transition hover:text-white">Random plugin</a>
                <a href="/getting-started" class="transition hover:text-white">Getting started</a>
                <a href="/credits" class="transition hover:text-white">Credits</a>
            </nav>
            <% if (allSoftware && allSoftware.length > 0 && allSoftware.some(function (s) { return s.globalPlugin; })) { %>
            <div>
                <div class="text-xs uppercase tracking-wide text-slate-400">Global stats</div>
                <div class="mt-3 grid gap-2">
                    <% for (var i = 0; i < allSoftware.length; i++) { %>
                    <% if (allSoftware[i].globalPlugin) { %>
                    <a href="/global/<%= allSoftware[i].url %>" class="flex items-center justify-between rounded-xl border border-white/10 px-3 py-2 transition hover:border-white/30 hover:text-white">
                        <span class="truncate"><%= allSoftware[i].name %></span>
                        <svg class="h-4 w-4 opacity-60" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                            <path fill-rule="evenodd" d="M6.22 5.22a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1 0 1.06l-4.5 4.5a.75.75 0 1 1-1.06-1.06L9.44 11H5.5a.75.75 0 0 1 0-1.5h3.94L6.22 6.28a.75.75 0 0 1 0-1.06z" clip-rule="evenodd"></path>
                        </svg>
                    </a>
                    <% } %>
                    <% } %>
                </div>
            </div>
            <% } %>
            <% if (loggedIn && myPlugins && myPlugins.length > 0) { %>
            <div>
                <div class="text-xs uppercase tracking-wide text-slate-400">My plugins</div>
                <div class="mt-3 grid gap-2">
                    <% for (var i = 0; i < myPlugins.length; i++) { %>
                    <a href="/plugin/<%= myPlugins[i].software.url %>/<%= myPlugins[i].name %>" class="flex items-center justify-between rounded-xl border border-white/10 px-3 py-2 transition hover:border-white/30 hover:text-white">
                        <span class="truncate"><%= myPlugins[i].name %></span>
                        <span class="ml-3 text-xs text-slate-400"><%= myPlugins[i].software.name %></span>
                    </a>
                    <% } %>
                </div>
            </div>
            <% } %>
            <div class="flex flex-col gap-3">
                <% if (loggedIn) { %>
                <a href="/author/<%= user.username %>" class="transition hover:text-white">My profile</a>
                <a href="/change-password" class="transition hover:text-white">Change password</a>
                <a href="/logout" class="transition hover:text-white">Logout</a>
                <a href="/add-plugin" class="accent-bg inline-flex items-center justify-center rounded-full px-4 py-2 text-sm font-semibold shadow-sm transition">Add plugin</a>
                <% } else { %>
                <a href="/login" class="rounded-full border border-white/15 px-4 py-2 text-center text-sm font-semibold text-white transition hover:border-white/40">Login</a>
                <a href="/register" class="accent-bg inline-flex items-center justify-center rounded-full px-4 py-2 text-sm font-semibold shadow-sm transition">Create account</a>
                <% } %>
            </div>
        </div>
    </div>
</header>

<script>
(function() {
    var toggle = document.getElementById('mobile-nav-toggle');
    var panel = document.getElementById('mobile-nav-panel');
    if (!toggle || !panel) {
        return;
    }

    var menuIcon = toggle.querySelector('[data-icon="menu"]');
    var closeIcon = toggle.querySelector('[data-icon="close"]');

    function setState(isOpen) {
        panel.classList.toggle('hidden', !isOpen);
        if (menuIcon) {
            menuIcon.classList.toggle('hidden', isOpen);
        }
        if (closeIcon) {
            closeIcon.classList.toggle('hidden', !isOpen);
        }
    }

    toggle.addEventListener('click', function() {
        var isOpen = panel.classList.contains('hidden');
        setState(isOpen);
    });

    panel.querySelectorAll('a').forEach(function(link) {
        link.addEventListener('click', function() {
            setState(false);
        });
    });

    window.addEventListener('resize', function() {
        if (window.innerWidth >= 1024) {
            setState(false);
        }
    });

    document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') {
            setState(false);
        }
    });
})();
</script>
