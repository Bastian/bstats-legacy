<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="description" content="A list with the plugin ids of all your plugins.">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0"/>
    <title>bStats - What is my plugin ID?</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Space+Grotesk:wght@500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/stylesheets/main.css" />
</head>
<body>

<% include templates/navigation.ejs %>
<main class="pb-24">
    <section class="doc-hero">
        <div class="doc-container py-16 sm:py-20">
            <div class="max-w-3xl space-y-4">
                <span class="badge bg-brand-100 text-brand-700">Account</span>
                <h1 class="font-display text-4xl font-semibold tracking-tight text-slate-900 sm:text-5xl">Plugin IDs</h1>
                <p class="text-base leading-relaxed text-slate-600">
                    Every plugin registered with bStats has an ID. Use it when instantiating the Metrics class. Here’s a quick way to copy them.
                </p>
            </div>
        </div>
    </section>

    <% if (!loggedIn) { %>
    <section class="doc-container mt-12">
        <div class="form-card space-y-4 text-center">
            <p class="text-sm text-slate-600">You need to be signed in to view your plugin IDs.</p>
            <a href="/login" class="btn-primary w-full justify-center">Log in</a>
        </div>
    </section>
    <% } else if (myPlugins.length <= 0) { %>
    <section class="doc-container mt-12 space-y-6">
        <div class="doc-card space-y-4 text-center">
            <h2 class="doc-card-title">No plugins yet</h2>
            <p class="text-sm text-slate-600">Once you add a plugin, we’ll show its ID here.</p>
            <a href="/add-plugin" class="btn-primary w-full justify-center sm:w-auto">Add your first plugin</a>
        </div>
        <div class="doc-card text-center">
            <p class="text-sm text-slate-600 mb-4">Until then, enjoy a random cat:</p>
            <img class="mx-auto w-full max-w-sm rounded-2xl border border-slate-200" src="https://cataas.com/cat?<%= Math.random() %>" alt="Random cat" loading="lazy">
        </div>
    </section>
    <% } else { %>
    <section class="doc-container mt-12 space-y-6">
        <div class="flex flex-col gap-3 sm:gap-2">
            <label class="input-label" for="pluginIdSearch">Filter plugins</label>
            <input id="pluginIdSearch" type="text" class="input-control" placeholder="Search by name or software">
        </div>
        <div class="overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-sm">
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-slate-200 text-sm">
                    <thead class="bg-slate-100 text-slate-500">
                    <tr>
                        <th class="px-4 py-3 text-left font-semibold uppercase tracking-[0.18em]">Plugin</th>
                        <th class="px-4 py-3 text-left font-semibold uppercase tracking-[0.18em]">Software</th>
                        <th class="px-4 py-3 text-left font-semibold uppercase tracking-[0.18em]">Plugin ID</th>
                        <th class="px-4 py-3 text-right font-semibold uppercase tracking-[0.18em]">Action</th>
                    </tr>
                    </thead>
                    <tbody id="pluginIdTable" class="divide-y divide-slate-200 text-slate-700">
                    <% for (var i = 0; i < myPlugins.length; i++) { %>
                    <tr class="hover:bg-slate-50 transition-colors">
                        <td class="px-4 py-3 font-semibold text-slate-900"><%= myPlugins[i].name %></td>
                        <td class="px-4 py-3 text-slate-600"><%= myPlugins[i].software.name %></td>
                        <td class="px-4 py-3 font-mono text-sm text-slate-800"><%= myPlugins[i].id %></td>
                        <td class="px-4 py-3 text-right">
                            <button type="button" class="copy-btn inline-flex items-center gap-2 rounded-full border border-slate-200 px-3 py-1.5 text-xs font-semibold text-slate-500 transition hover:border-brand-200 hover:text-brand-600" data-plugin-id="<%= myPlugins[i].id %>">
                                Copy ID
                            </button>
                        </td>
                    </tr>
                    <% } %>
                    </tbody>
                </table>
            </div>
        </div>
    </section>
    <% } %>
</main>

<% include templates/footer.ejs %>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const rows = document.querySelectorAll('#pluginIdTable tr');
        const searchInput = document.getElementById('pluginIdSearch');
        if (searchInput) {
            searchInput.addEventListener('input', () => {
                const query = searchInput.value.trim().toLowerCase();
                rows.forEach((row) => {
                    const text = row.textContent.toLowerCase();
                    row.style.display = text.includes(query) ? '' : 'none';
                });
            });
        }

        document.querySelectorAll('.copy-btn').forEach((button) => {
            button.addEventListener('click', async () => {
                const pluginId = button.getAttribute('data-plugin-id');
                try {
                    await navigator.clipboard.writeText(pluginId);
                    button.textContent = 'Copied!';
                    setTimeout(() => (button.textContent = 'Copy ID'), 1500);
                } catch (err) {
                    button.textContent = 'Failed';
                }
            });
        });
    });
</script>

<% include templates/globalScripts.ejs %>

</body>
</html>
